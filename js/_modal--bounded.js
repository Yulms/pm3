import{isEscapePressEvent}from"./util.js";class ModalBounded{constructor(e){const t={openButtonSelector:void 0,modalSelector:void 0,parentSelector:void 0,parentBoundSelector:"modal__parent-bound",closeModalClass:"modal--closed",overlaySelector:"overlay",showDelay:150,closeDelay:200};Object.assign(this,t,e),this._parentElement=void 0,this._modalElement=void 0,this._isOpened=!1,this._buttonElement=document.querySelector(this.openButtonSelector),this._buttonElement.addEventListener("click",this._showModal.bind(this)),this._buttonElement.addEventListener("mouseenter",e=>{this._timerOpenId=setTimeout(()=>this._showModal(e),this.showDelay)}),this._buttonElement.addEventListener("mouseleave",()=>clearTimeout(this._timerOpenId))}_showModal(e){this._isOpened||(e.preventDefault(),(()=>{this._parentElement&&this._modalElement||(this._parentElement=document.querySelector(this.parentSelector),this._modalElement=this._parentElement.querySelector(this.modalSelector))})(),(()=>{this._overlayElement=document.createElement("div"),this._overlayElement.classList.add(this.overlaySelector),this._parentElement.before(this._overlayElement)})(),(()=>{this._parentElement.classList.add(this.parentBoundSelector),this._modalElement.classList.remove(this.closeModalClass)})(),(()=>{this._onOverlayClick=()=>{clearTimeout(this._timerCloseId),this._closeModal()},this._onDocumentKeydown=e=>{isEscapePressEvent(e,this._closeModal.bind(this))},this._onCloseButtonClick=()=>{this._closeModal()},this._onModalMouseLeave=()=>{this._timerCloseId=setTimeout(()=>this._closeModal(),this.closeDelay)},this._onModalMouseEnter=()=>{clearTimeout(this._timerCloseId)},this._overlayElement.addEventListener("click",this._onOverlayClick),document.addEventListener("keydown",this._onDocumentKeydown),this._parentElement.addEventListener("mouseleave",this._onModalMouseLeave),this._parentElement.addEventListener("mouseenter",this._onModalMouseEnter)})(),this._isOpened=!0)}_closeModal(){(()=>{this._overlayElement.remove()})(),(()=>{this._parentElement.classList.remove(this.parentBoundSelector),this._modalElement.classList.add(this.closeModalClass)})(),(()=>{this._overlayElement.removeEventListener("click",this._onOverlayClick),document.removeEventListener("keydown",this._onDocumentKeydown),this._parentElement.removeEventListener("mouseleave",this._onModalMouseLeave),this._parentElement.removeEventListener("mouseenter",this._onModalMouseEnter)})(),this._isOpened=!1}}function initBoundedModals(){return[new ModalBounded({openButtonSelector:".header__contacts-button",modalSelector:".header__contacts .modal",parentSelector:".header__contacts"}),new ModalBounded({openButtonSelector:".header__user .header__link",modalSelector:".header__user .modal",parentSelector:".header__user"}),new ModalBounded({openButtonSelector:".header__cart .header__link",modalSelector:".header__cart .modal",parentSelector:".header__cart"})]}export default initBoundedModals;